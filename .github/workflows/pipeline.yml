# This is my first WorkFlow With GithubActions


name: Deployment Pipeline

#Controls when the workflow will run
on:
  push:
    branches: [main]

# env:
#   AZURE_WEBAPP_NAME: mariodemo   # set this to your application's name
#   AZURE_WEBAPP_PACKAGE_PATH: '.'      # set this to the path to your web app project, defaults to the repository root
#   NODE_VERSION: '14.x'                # set this to the node version to use


jobs:
  Say-Hello:
      runs-on: ubuntu-18.04
      steps:
        # Checks-out your repository under $GITHUB_WORKSPACE, so your job can access it
        - uses: actions/checkout@v3
        # Runs a single command using the runners shell
        - name: üëã Say Hello World
          run: echo Hello, World!
        - name: üñ•Ô∏è Set Commands in multiple lines
          run: |
            echo Add other actions to build
            echo test, and deploy proyect
  Check-Linter-Quality:
    runs-on: ubuntu-18.04
    steps:
      - uses: actions/checkout@v3
        with:
          fetch-depth: 0
      - uses: actions/setup-node@v2
        with:
          cache: 'npm'
          node-version: '14'
      - name: üö©Install dependencies
        run: npm ci
      - name: ü§òLint
        run: npm run lint
  Build-and-Deploy:
    name: Build and Deploy
    runs-on: ubuntu-latest
    environment: dev
    steps:
    - uses: actions/checkout@master
    - name: Use Node.js ${{ env.NODE_VERSION }}
      uses: actions/setup-node@v1
      with:
        node-version: ${{ env.NODE_VERSION }}
    - name: npm install, build
      run: |
          # Build and test the project, then
          # deploy to Azure Web App.
          npm ci
          npm run build --if-present
    - name: 'Login in Azure'
      uses: azure/login@v1
      with:
        creds: ${{ secrets.AZURE_CREDENTIALS }}
      env:
          creds: ${{ secrets.AZURE_CREDENTIALS }}
      run: |
        az webapp list --query "[?state=='Running']"
    # - name: 'Deploy to Azure WebApp'
    #   uses: azure/webapps-deploy@v2
    #   with: 
    #     app-name: ${{ env.AZURE_WEBAPP_NAME }}
    #     publish-profile: ${{ secrets.AZURE_WEBAPP_PUBLISH_PROFILE }}
    #     package: ${{ env.AZURE_WEBAPP_PACKAGE_PATH }}